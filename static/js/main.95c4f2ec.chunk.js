(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(e,t,n){e.exports=n(22)},19:function(e,t,n){e.exports=n.p+"static/media/move.7d5eff42.mp3"},20:function(e,t,n){e.exports=n.p+"static/media/popup.4af4d408.mp3"},21:function(e,t,n){},22:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(9),i=n.n(a),l=n(5),c=n(7),s=n(1),u={fillStyle:"rgba(0, 0, 0, 0)",strokeStyle:"rgba(0, 0, 0, 0)",lineWidth:0,textAlign:"start",textBaseline:"top",fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",fontSize:16,fontFamily:'-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji"'};function f(e,t){t.font=t.font||"".concat(t.fontStyle||u.fontStyle," ").concat(t.fontVariant||u.fontVariant," ").concat(t.fontWeight||u.fontWeight," ").concat(t.fontSize||u.fontSize,"px ").concat(t.fontFamily||u.fontFamily),Object.keys(t).forEach(function(n){n in e&&t[n]&&(e[n]=t[n])})}function v(e){return"string"===typeof e||"number"===typeof e}function h(e,t,n){o.a.Children.forEach(t,function(t){if(c=t,o.a.isValidElement(c)&&c.type.callName){var r=Object(s.a)({},n,t.props);if(r.x=n.x+(t.props.x||0),r.y=n.y+(t.props.y||0),function(e){return"Layout"===e.type.callName}(t))if(t.props.column){var a=0;o.a.Children.forEach(t.props.children,function(t){r.x+=a,a=(t.props.x||0)+(t.props.w||0),h(e,t,r)})}else{var i=0;o.a.Children.forEach(t.props.children,function(t){r.y+=i,i=(t.props.y||0)+(t.props.h||0),h(e,t,r)})}else!function(e){return"Text"===e.type.callName}(t)?(d[t.type.callName].call(e,r),h(e,t.props.children,r)):h(e,v(t.props.text)?t.props.text:t.props.children,r)}else if(v(t)){var l=Object(s.a)({},n,{text:t});"center"===n.textAlign&&(l.x=(n.x||0)+(n.w||0)/2),"middle"===n.textBaseline&&(l.y=(n.y||0)+(n.h||0)/2),n.fontFillStyle&&(l.fillStyle=n.fontFillStyle),n.fontStrokeStyle&&(l.strokeStyle=n.fontStrokeStyle),d.Text.call(e,l)}var c})}function d(e){var t=e.children,n=e.canvasStyles,a=Object(c.a)(e,["children","canvasStyles"]),i=Object(r.useRef)(null),l=Object(r.useMemo)(function(){return function(){return i.current&&i.current.getContext("2d")}},[]);return Object(r.useEffect)(function(){var e=l();e&&f(e,Object(s.a)({},u,n))},[n,l]),Object(r.useEffect)(function(){var e=l();if(e){var n=e.canvas.width,r=e.canvas.height;e.clearRect(0,0,n,r),h(e,t,{x:0,y:0,w:n,h:r})}}),o.a.createElement("canvas",Object.assign({ref:i},a))}function m(e){return null}function b(e){e.children;var t=e.x,n=void 0===t?0:t,r=e.y,o=void 0===r?0:r,a=e.w,i=void 0===a?0:a,l=e.h,s=void 0===l?0:l,u=e.r,v=Object(c.a)(e,["children","x","y","w","h","r"]),h=this;return h.save(),f(h,v),h.beginPath(),u?(h.moveTo(n+u,o),h.arcTo(n+i,o,n+i,o+s,u),h.arcTo(n+i,o+s,n,o+s,u),h.arcTo(n,o+s,n,o,u),h.arcTo(n,o,n+i,o,u)):h.rect(n,o,i,s),h.closePath(),h.fill(),v.lineWidth&&h.stroke(),h.restore(),null}function y(e){var t=e.children,n=e.text,r=e.x,o=void 0===r?0:r,a=e.y,i=void 0===a?0:a,l=e.maxWidth,s=Object(c.a)(e,["children","text","x","y","maxWidth"]),u=v(n)?n.toString():v(t)?t.toString():"";return this.save(),f(this,s),this.fillText(u,o,i,l),s.lineWidth&&this.strokeText(u,o,i,l),this.restore(),null}m.callName="Layout",d.Layout=m,b.callName="Rect",d.Rect=b,y.callName="Text",d.Text=y;var g=d,p="ADD_TILE",w="LEFT",x="DOWN",E="RIGHT",S="UP",O="SET_BOARD_LENGTH",k="INITI",j="UNDO";var T=n(6),N=n(3),R=n(4),W=n(10),z=n(2),L=n(11),M=n(12),C=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Object(N.a)(this,t),n=Object(W.a)(this,Object(z.a)(t).call(this,e)),r.forEach(function(e){n.value[e.y][e.x]=e}),n}return Object(M.a)(t,e),Object(R.a)(t,[{key:"addTile",value:function(){var e=this.emptyPositions,t=e.length;if(!t)return!1;var n=e[Math.random()*t|0],r=n.x,o=n.y;return this.value[o][r]={y:o,x:r,value:Math.random()>.1?2:4},!0}},{key:"isEqual",value:function(e){return Object(L.a)(Object(z.a)(t.prototype),"isEqual",this).call(this,e,function(e,t){return null!==e&&null!==t?e.value!==t.value:e!==t})}},{key:"moveToFront",value:function(e){var t=this;this.value.forEach(function(n,r){t.value[r]=t.moveRowToFront(n,e)})}},{key:"moveToBack",value:function(e){var t=this;this.value.forEach(function(n,r){t.value[r]=t.moveRowToBack(n,e)})}},{key:"moveRowToFront",value:function(e,t){var n=[],r=0,o=e.length-1,a=NaN;return e.forEach(function(e){null!==e?a===e.value?(t(2*e.value),n[r-1]=Object(s.a)({},e,{value:2*e.value}),n[o--]=null,a=NaN):(n[r++]=Object(s.a)({},e),a=e.value):n[o--]=null}),n}},{key:"moveRowToBack",value:function(e,t){return this.moveRowToFront(Object(T.a)(e).reverse(),t).reverse()}},{key:"tiles",get:function(){var e=[];return this.value.forEach(function(t,n){return t.forEach(function(t,r){null!==t&&(e[e.length]=Object(s.a)({},t,{y:n,x:r}))})}),e}}]),t}(function(){function e(t){Object(N.a)(this,e),this.value=void 0,this.size=void 0;var n="number"===typeof t,r=n?t:t.length;this.size=r,this.value=[];for(var o=0;o<r;o++){for(var a=[],i=0;i<r;i++)a[i]=n?null:t[o][i];this.value[o]=a}}return Object(R.a)(e,[{key:"transposeMatrix",value:function(){var t=this,n=new e(this.value);this.value.forEach(function(e,r){return e.forEach(function(e,o){t.value[o][r]=n.value[r][o]})})}},{key:"isEqual",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t){return e!==t},n=e.size;if(this.size!==n)return!1;for(var r=0;r<n;r++)for(var o=0;o<n;o++)if(t(this.value[r][o],e.value[r][o]))return!1;return!0}},{key:"emptyPositions",get:function(){var e=[];return this.value.forEach(function(t,n){return t.forEach(function(t,r){null===t&&(e[e.length]={y:n,x:r})})}),e}}]),e}()),A={handleKey:function(e,t){for(var n,r,o=e[arguments.length>2&&void 0!==arguments[2]?arguments[2]:"keyCode"],a=0,i=t.length;a<i;a++){var c=Object(l.a)(t[a],2);if(n=c[0],r=c[1],n.includes(o))return r(e),void e.preventDefault()}},save:function(e,t){return!!window.localStorage&&(window.localStorage.setItem(e,JSON.stringify(t)),!0)},load:function(e){return!!window.localStorage&&JSON.parse(window.localStorage.getItem(e))}},B="GAME2048",F=10;function I(e,t,n){return(e-(t+1)*n)/t}function U(e){var t=function(e){var t=new C(e.size,e.tiles),n=0;return t.moveToFront(function(e){return n+=e}),{isRemovable:!e.isEqual(t),score:n,tileMatrix:t}}(e),n=function(e){var t=new C(e.size,e.tiles),n=0;return t.transposeMatrix(),t.moveToBack(function(e){return n+=e}),t.transposeMatrix(),{isRemovable:!e.isEqual(t),score:n,tileMatrix:t}}(e),r=function(e){var t=new C(e.size,e.tiles),n=0;return t.moveToBack(function(e){return n+=e}),{isRemovable:!e.isEqual(t),score:n,tileMatrix:t}}(e),o=function(e){var t=new C(e.size,e.tiles),n=0;return t.transposeMatrix(),t.moveToFront(function(e){return n+=e}),t.transposeMatrix(),{isRemovable:!e.isEqual(t),score:n,tileMatrix:t}}(e),a=function(e,t,n,r,o){return!(e.value.some(function(e){return e.some(function(e){return null===e})})||t.isRemovable||n.isRemovable||r.isRemovable||o.isRemovable)}(e,t,n,r,o);return{tiles:e.tiles,left:t,down:n,right:r,up:o,gameover:a}}function D(e,t){return Object(s.a)({},e,function(e,t){var n=e.score+t.score,r=n<e.best?e.best:n;return{tileMatrix:t.tileMatrix,tiles:t.tileMatrix.tiles,score:n,best:r}}(e,t),{lock:!0})}function P(e){var t=e.size,n=e.gup,r=e.boardLength,o=e.score,a=e.best,i=e.tiles,l=e.history,c=new C(t,i);if(0===i.length){for(var u=2;u-- >0&&c.addTile(););l[l.length]={score:o,best:a,tiles:c.tiles},l.length>F&&l.shift(),A.save(B,l)}var f=U(c);return Object(s.a)({size:t,gup:n,boardLength:r,score:o,best:a,cellLength:I(r,t,n),tileMatrix:c,lock:!1,history:l},f)}function q(e,t){switch(t.type){case p:for(var n=t.addCount;n-- >0&&e.tileMatrix.addTile(););var r=Object(s.a)({},e,U(e.tileMatrix),{lock:!1});return r.history[r.history.length]={score:r.score,best:r.best,tiles:Object(T.a)(r.tiles)},r.history.length>F&&r.history.shift(),A.save(B,e.history),r;case w:return D(e,e.left);case x:return D(e,e.down);case E:return D(e,e.right);case S:return D(e,e.up);case O:var o=t.boardLength;return Object(s.a)({},e,{boardLength:o,cellLength:I(o,e.size,e.gup)});case k:return P(t.initialState);case j:e.history.pop(),A.save(B,e.history);var a=e.history[e.history.length-1];return P(Object(s.a)({},e,a));default:return e}}function G(e){var t=function(e){var t=Object(r.useRef)(e);return Object(r.useEffect)(function(){t.current=e},[e]),t}(e);return Object(r.useCallback)(function(){return t.current&&t.current.apply(t,arguments)},[t])}var H=n(19),J=n(20),V=new Audio(H),_=new Audio(J),K={2:"#fff9c4",4:"#ffe082",8:"#ffb74d",16:"#ffab91",32:"#ef9a9a",64:"#f06292",128:"#ab47bc",256:"#9575cd",512:"#0091ea",1024:"#00b8d4",2048:"#00bfa5",4096:"#00c853",8192:"#aeea00",cell:"#d7ccc8",board:"#bcaaa4",title:"#0091ea",score:"#ec407a",scoreNumber:"#f1f8e9",scoreText:"#efebe9",best:"#ff5722",bestNumber:"#f1f8e9",bestText:"#efebe9",gameover:"#efebe9aa",gameoverText:"#795548",black:"#212121"},$={1:[34,42],2:[30,36],3:[26,34],4:[22,32]},Q=640,X=320,Y=64,Z={LEFT:37,UP:38,RIGHT:39,DOWN:40,A:65,S:83,D:68,W:87};function ee(e,t){return(t>Q?Q:t<X?X:t)-2*e}function te(){var e=Object(r.useReducer)(q,function(){var e=A.load(B)||[],t=0,n=0,r=[];if(e.length){var o=e[e.length-1];r=o.tiles,t=o.score,n=o.best}return{size:4,gup:8,boardLength:ee(8,window.innerWidth),score:t,best:n,tiles:r,history:e}}(),P),t=Object(l.a)(e,2),n=t[0],a=t[1],i=n.size,c=n.gup,s=n.boardLength,u=n.cellLength,f=n.score,v=n.best,h=n.tiles,d=n.left,T=n.down,N=n.right,R=n.up,W=n.gameover,z=n.lock,L=n.history,M=Object(r.useRef)(),C=s>(Q+X)/2-c,F=Object(r.useMemo)(function(){return{width:s}},[s]),I=Object(r.useMemo)(function(){return function(e,t,n,r,a,i){var l=e/2.5,c=i?16:12,s=2*c;return o.a.createElement(m,{column:!0,h:e+2*t},o.a.createElement(y,{text:"2048",w:n/2,h:e+2*t,fontSize:e/4*3,fillStyle:K.title,fontWeight:"bold",textAlign:"center",textBaseline:"middle"}),o.a.createElement(b,{x:t,y:t,w:n/4-t,h:e,r:t/2,fillStyle:K.score,fontWeight:"bold",textAlign:"center",textBaseline:"middle"},o.a.createElement(y,{text:"SCORE",h:l,fontSize:c,fillStyle:K.scoreText}),o.a.createElement(y,{text:r,y:l,h:e-l,fontSize:s,fillStyle:K.scoreNumber})),o.a.createElement(b,{x:t,y:t,w:n/4-t,h:e,r:t/2,fillStyle:K.best,fontWeight:"bold",textAlign:"center",textBaseline:"middle"},o.a.createElement(y,{text:"BEST",h:l,fontSize:c,fillStyle:K.bestText}),o.a.createElement(y,{text:a,y:l,h:e-l,fontSize:s,fillStyle:K.bestNumber})))}(Y,c,s,f,v,C)},[f,v,s,c,C]),U=Object(r.useMemo)(function(){return function(e,t,n){for(var r=[],a=0;a<e;a++)for(var i=0;i<e;i++)r[r.length]=o.a.createElement(b,{key:a+"/"+i,x:i*(n+t)+t,y:a*(n+t)+t,w:n,h:n,r:t/2,fillStyle:K.cell});return r}(i,c,u)},[u,c,i]),D=Object(r.useMemo)(function(){return function(e,t,n,r){var a=r?1:0;return e.map(function(e,r){var i=e.x,l=e.y,c=e.value;return o.a.createElement(b,{key:"tile"+r,x:i*(n+t)+t,y:l*(n+t)+t,w:n,h:n,r:t/2,fillStyle:K[c],fontFillStyle:K.black,fontSize:$[c.toString().length][a],fontWeight:"bold",textAlign:"center",textBaseline:"middle"},c)})}(h,c,u,C)},[h,u,c,C]),H=Object(r.useCallback)(function(e){a(e),V.play()},[]),J=Object(r.useCallback)(function(){window.clearTimeout(M.current),M.current=window.setTimeout(function(){a(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{type:p,addCount:e}}()),_.play()},255)},[]),te=G(function(){!z&&d.isRemovable&&(H({type:w}),J())}),ne=G(function(){!z&&T.isRemovable&&(H({type:x}),J())}),re=G(function(){!z&&N.isRemovable&&(H({type:E}),J())}),oe=G(function(){!z&&R.isRemovable&&(H({type:S}),J())}),ae=G(function(){!z&&L.length>1&&a({type:j})}),ie=G(function(){a({type:k,initialState:{size:i,gup:c,boardLength:s,best:v,score:0,tiles:[],history:L}})});return Object(r.useEffect)(function(){var e=function(e){A.handleKey(e,[[[Z.LEFT,Z.A],te],[[Z.DOWN,Z.S],ne],[[Z.RIGHT,Z.D],re],[[Z.UP,Z.W],oe]])};return window.addEventListener("keydown",e),function(){return window.removeEventListener("keydown",e)}},[]),Object(r.useEffect)(function(){var e=function(){return a((e=ee(c,window.innerWidth),{type:O,boardLength:e}));var e};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}},[c]),Object(r.useEffect)(function(){return function(){return window.clearTimeout(M.current)}},[]),o.a.createElement("div",{className:"center",style:F},o.a.createElement(g,{width:s,height:s+Y+3*c},o.a.createElement(m,null,I,o.a.createElement(b,{x:0,y:0,w:s,h:s,r:c/2,fillStyle:K.board},U,D,W&&o.a.createElement(b,{key:"gameover",x:0,y:0,w:s,h:s,r:c/2,fillStyle:K.gameover,fontFillStyle:K.gameoverText,fontSize:s/8,fontWeight:"bold",textAlign:"center",textBaseline:"middle"},"Game over!")))),o.a.createElement("div",{className:"control"},o.a.createElement("div",{className:"btn-group"},o.a.createElement("button",{className:"btn",onClick:ie},"New Game"),o.a.createElement("button",{className:"btn",onClick:ae,disabled:z||L.length<=1},"Undo")),o.a.createElement("div",{className:"arraw-group"},o.a.createElement("div",null,o.a.createElement("button",{className:"btn",disabled:z||!R.isRemovable,onClick:oe},o.a.createElement("span",{className:"iconfont"},"\ue7ed"))),o.a.createElement("div",null,o.a.createElement("button",{className:"btn",disabled:z||!d.isRemovable,onClick:te},o.a.createElement("span",{className:"iconfont"},"\ue7ec")),o.a.createElement("button",{className:"btn",disabled:z||!T.isRemovable,onClick:ne},o.a.createElement("span",{className:"iconfont"},"\ue7ee")),o.a.createElement("button",{className:"btn",disabled:z||!N.isRemovable,onClick:re},o.a.createElement("span",{className:"iconfont"},"\ue7eb"))))))}var ne=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function re(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}n(21);i.a.render(o.a.createElement(function(){return o.a.createElement(te,null)},null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/game",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/game","/service-worker.js");ne?(function(e,t){fetch(e).then(function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):re(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):re(t,e)})}}()}},[[13,1,2]]]);
//# sourceMappingURL=main.95c4f2ec.chunk.js.map